"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8848],{62600:function(e,t,a){a.d(t,{r:function(){return n.Z}});var n=a(62653)},2794:function(e,t,a){a.d(t,{IS:function(){return useBlastPointsItems},aG:function(){return BlastPointCards}});var n=a(31113),s=a(26361),r=a(33621),l=a(20449),i=a(19757),o=a(90168),c=a(59175),d=a(15948),u=a(45438),m=a(47518),x=a(76034),p=a(75930),b=a(84944),f=a(64103),h=a(73083),g=a(84570),v=a(42341),k=a(12045);let N={USB:"rgba(226, 254, 182, 1)",USB_dark:"#E2FEB6",ETHx:"rgba(238, 234, 254, 1)",IPx:"rgba(238, 234, 254, 1)",ETHx_dark:"linear-gradient(90deg, #C2B7FD 0%, #746D97 100%)",IPx_dark:"linear-gradient(90deg, #C2B7FD 0%, #746D97 100%)",USDBx:"linear-gradient(90deg, rgba(16, 185, 129, 0.25) 0%, rgba(99, 102, 241, 0.25) 100%)",USDBx_dark:"linear-gradient(90deg, #C2B7FD 0%, #6366F1 100%)"},j={USB:"rgba(196, 241, 126, 1)",ETHx:"rgba(219, 210, 255, 1)",IPx:"rgba(219, 210, 255, 1)",USDBx:"rgba(255, 255, 255, 1)"};function useBlastPointsItems(){let e=(0,c.p)(),{prices:t,usbApr:a}=(0,f.useContext)(p.g),n=(0,x.a)(),r=(0,u.i)(),o=(0,m.m)(),d=(0,f.useMemo)(()=>{let a=[],r=i.iK[e];if(l.DF.find(t=>t.id==e)){let c=t[i.K8],d=t[i.O1[e]],calcPoint=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100n;return 0n==c?"0":(0,b.Rp)(6504987n*302400n*e*t/c,0,8)};a.push({symbol:"USB",tit:"APY:".concat((0,s.Jh)(o[i.O1[e]],10)," ~ ").concat((0,s.Jh)(o.USB_END,10)),sub:"~ Interest + Earning",point:calcPoint(d),per:100}),r.filter(e=>"USDB"==e.assetTokenSymbol||e.assetTokenSymbol==(0,l.b)()).forEach(e=>{let r=e.assetTokenSymbol==(0,l.b)()?"".concat((0,l.b)()," GAIN BOOSTER"):"APY:".concat((0,s.Jh)(o[e.xTokenAddress],10)),i=e.isStable&&(0,l.WA)()?"~ ".concat(n[e.vault].toFixed(2),"x Blast Native Yield"):"~ ".concat(n[e.vault].toFixed(2),"x Leveraged long on ").concat(e.assetTokenSymbol);a.push({symbol:e.xTokenSymbol,tit:r,sub:i,point:calcPoint(t[e.xTokenAddress],e.xTokenSymbol=="".concat((0,l.b)(),"x")?1n:100n),per:e.xTokenSymbol=="".concat((0,l.b)(),"x")?1:100})})}return a},[e,t,n,a,r]);return d}function BlastPointCard(e){let{symbol:t,tit:a,sub:d,point:u}=e,m=(0,c.p)(),x=(0,f.useMemo)(()=>{var e,a;let n=(0,o.l)(m,!1),r={USB:"USDB",["".concat((0,l.b)(),"x")]:(0,l.b)(),USDBx:"USDB"},c=null===(e=n.find(e=>e.symbol==r[t]))||void 0===e?void 0:e.address,d=null===(a=n.find(e=>e.symbol==t))||void 0===a?void 0:a.address;if(!c||!d)return"";let convertNative=e=>e==i.K8?"0x0000000000000000000000000000000000000000":e;return(0,s.h$)(convertNative(c),convertNative(d))},[m]),p=(0,k.l)(e=>e.theme);return(0,n.jsxs)("div",{style:{boxShadow:"0px 0px 12px 0px rgba(187, 215, 144, 0.4)"},className:"rounded-2xl overflow-hidden bg-white text-base flex flex-col dark:bg-slate-950",children:[(0,n.jsxs)("div",{className:"flex md:flex-wrap items-center p-4 gap-2 dark:text-black",style:{background:N["".concat(t,"_").concat(p)]||N[t]},children:[(0,n.jsx)(r.c,{symbol:t,size:42,className:"shrink-0"}),(0,n.jsx)("div",{className:"font-semibold",children:t}),(0,n.jsxs)("div",{className:"whitespace-nowrap text-center text-sm ml-auto flex flex-col items-center flex-1",children:[(0,n.jsx)("div",{className:"rounded-full px-2 py-[2px] w-fit",style:{background:j[t]},children:a}),(0,n.jsx)("div",{className:"mt-1",children:d})]})]}),(0,n.jsx)("div",{className:"flex justify-between p-4 whitespace-nowrap text-sm items-center gap-2",children:(0,n.jsxs)("a",{className:"underline text-slate-500 dark:text-slate-50 flex items-center gap-1",href:x,target:"_blank",children:["Swap on Thruster ",(0,n.jsx)(h.Ig3,{})]})})]})}function BlastPointCards(){let e=useBlastPointsItems(),[t,a]=(0,d.n)(e=>{let{width:t}=e;return t<970});return 0==e.length?null:(0,n.jsxs)("div",{ref:t,className:"grid grid-cols-1 md:grid-cols-3 gap-5 md:pb-[60px]",children:[!a&&e.map(e=>(0,n.jsx)(BlastPointCard,{...e},e.symbol)),a&&(0,n.jsx)(v.tq,{spaceBetween:20,pagination:{clickable:!0,renderBullet:function(e,t){return'<div class="'+t+'"></div>'}},className:"-translate-x-[1rem] !px-4 !pb-10 !w-screen",modules:[g.tl],children:e.map(e=>(0,n.jsx)(v.o5,{children:(0,n.jsx)(BlastPointCard,{...e})},e.symbol))})]})}},35664:function(e,t,a){a.d(t,{Z:function(){return ConnectBtn}});var n=a(31113),s=a(33883),r=a(44726);function ConnectBtn(){return(0,r.Z)(1024),(0,n.jsx)(s.NL,{chainStatus:"none",showBalance:!1})}},41267:function(e,t,a){a.d(t,{a:function(){return MigrationTip}});var n=a(31113),s=a(26504),r=a(19757),l=a(59175),i=a(15506),o=a(26361),c=a(84944),d=a(69708),u=a(64103),m=a(69426),x=a(37754),p=a(14993),b=a(22298),f=a(7745),h=a(72366);function DefEmpty(){return(0,n.jsx)("tr",{className:"text-lg font-normal text-center text-black ",children:(0,n.jsx)("td",{colSpan:100,className:"h-[100px] py-5 align-top"})})}var simple_table=e=>{let{header:t,data:a,span:s={},empty:r=(0,n.jsx)(DefEmpty,{}),className:l="relative min-w-full bg-transparent ",headerClassName:i,headerItemClassName:c,tbodyClassName:d="",rowClassName:u,rowStyle:m,cellClassName:x,onClickRow:p,onRowMouseHover:b}=e;return(0,n.jsxs)("table",{className:(0,o.cn)("relative min-w-full bg-transparent ",l),children:[(0,n.jsx)("thead",{className:"",children:(0,n.jsx)("tr",{className:(0,o.cn)("text-left whitespace-nowrap font-normal text-black border-b border-gray-100 pt-5 pb-6 dark:text-slate-50 dark:border-zinc-600",i),children:t.map((e,t)=>(0,n.jsx)("th",{colSpan:s[t],scope:"col",className:(0,o.cn)(0==s[t]?"p-0 w-0":"p-3 font-normal text-sm",c),children:e},t))})}),(0,n.jsxs)("tbody",{className:(0,o.cn)(d),children:[a.map((e,a)=>(0,n.jsx)("tr",{onClick:()=>p&&p(a),onMouseEnter:()=>b&&b(a),onMouseLeave:()=>b&&b(-1),style:"function"==typeof m?m(a):m,className:(0,o.cn)("text-slate-700 dark:text-slate-50 font-medium whitespace-nowrap",p?"cursor-pointer hover:bg-slate-400/10":"","function"==typeof u?u(a):u),children:e.map((e,r)=>r>=t.length?(0,n.jsx)(n.Fragment,{children:e}):(0,n.jsx)("td",{colSpan:s[r],className:(0,o.cn)(0==s[r]?"p-0 w-max":"px-3 py-2 text-sm w-max","function"==typeof x?x(a,r):x),children:e},r))},a)),0===a.length&&r]})]})},g=a(33621),v=a(2987),k=a(36762),N=a(64370);function MarginLoan(e){let{symbol:t,value:a}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-2 pr-8",children:[(0,n.jsx)(g.c,{symbol:t,size:20}),(0,n.jsx)("span",{children:(0,c.dq)(a)})]})}function bnGt(e){return e>=200000n?e:0n}function MigrationV2(){let e=(0,l.p)(),t=r.Lh[e][0],a=r.Lh[e][1],x=r.iK[e][0],g=r.iK[e][1],[j,y]=(0,p.Z)(!1),{address:S,chain:B}=(0,h.m)(),{data:T,isFetching:w}=function(e){let t=(0,l.p)(),{address:a}=(0,h.m)(),n=r.Lh[t][0],c=r.Lh[t][1],d=(0,i.lo)(),queryFn=async()=>{let e=await Promise.all([{abi:b.Wo,address:n.xTokenAddress,functionName:"balanceOf",args:[a]},{abi:b.Wo,address:c.xTokenAddress,functionName:"balanceOf",args:[a]},{abi:s.aT,address:n.ptyPoolAboveAddress,functionName:"userStakingBalance",args:[a]},{abi:s.aT,address:n.ptyPoolBelowAddress,functionName:"userStakingBalance",args:[a]},{abi:b.Wo,address:r.O1[t],functionName:"balanceOf",args:[a]},{abi:b.Wo,address:n.xTokenAddress,functionName:"totalSupply"},{abi:s.WW,address:n.vault,functionName:"usbTotalSupply"},{abi:s.aT,address:n.ptyPoolBelowAddress,functionName:"earnedStakingYields",args:[a]}].map(e=>d(e))),l=(0,o.ok)(e,[7]),i=(0,o.ok)(e,[0]),u=i+l,m=(0,o.ok)(e,[1]),x=(0,o.Rj)(e,[2]),p=(0,o.Rj)(e,[3]),f=(0,o.ok)(e,[4]),h=(0,o.ok)(e,[5]),g=(0,o.ok)(e,[6]),v=await Promise.all([bnGt(i)?d({abi:s.Wn,address:r.O6[t],functionName:"calcPairedRedeemAssetAmount",args:[n.vault,i]}).then(e=>e[1]):0n,bnGt(m)?d({abi:s.Wn,address:r.O6[t],functionName:"calcRedeemByMarginTokensFromStableVault",args:[c.vault,r.e_[t],m]}).then(e=>e[2]):0n]),k=i?(0,o.ok)(v,[0]):0n,N=m?(0,o.ok)(v,[1]):0n;return{earnEthx:l,ethxBalance:i,ethxTotal:u,usdbxBalance:m,ethStaked:x,usbStaked:p,usbBalance:f,usbTotal:f+p,ethxMarginloan:h>0n?-(u*g)/h:0n,ethOutAmount:k,usdbOutAmount:N}};return(0,N.a)({queryFn,queryKey:[t,a,e],refetchOnMount:!1,refetchOnWindowFocus:!1,initialData:(0,o.Yb)({},0n)})}(j),A=T.usbTotal+T.ethxMarginloan<10000n&&bnGt(T.ethxTotal)>0n,P=T.ethxTotal+T.usdbxBalance+T.ethStaked<=0n,{mutateAsync:E,isPending:C,finishCount:D,reset:M}=(0,i.Lh)(),O=Object.values(T).toString(),V=(0,u.useMemo)(()=>{let e=[];return bnGt(T.usbStaked)?e.push({name:"Withdraw USB from V1 Earn Pool",abi:s.aT,address:t.ptyPoolBelowAddress,functionName:"exit"}):bnGt(T.earnEthx)&&e.push({name:"Withdraw USB from V1 Earn Pool",abi:s.aT,address:t.ptyPoolBelowAddress,functionName:"claimAll"}),bnGt(T.ethStaked)&&e.push({name:"Withdraw ETH from V1 Earn Pool",abi:s.aT,address:t.ptyPoolAboveAddress,functionName:"exit"}),bnGt(T.ethxTotal)&&e.push({name:"Redeem ETH from V1 Vault",abi:s.WW,address:t.vault,functionName:"redeemByPairsWithExpectedMarginTokenAmount",args:[T.ethxTotal]}),bnGt(T.ethOutAmount)&&e.push({name:"Deposit ETH to V2 Vault",abi:s.WW,address:x.vault,functionName:"mintPairs",args:[T.ethOutAmount],value:T.ethOutAmount}),bnGt(T.usdbxBalance)&&e.push({name:"Redeem USDB from V1 Vault",abi:s.S4,address:a.vault,functionName:"redeemByMarginTokens",args:[T.usdbxBalance]}),bnGt(T.usdbOutAmount)&&S&&e.push({name:"Deposit USDB to V2 Vault",abi:s.S4,address:g.vault,functionName:"mintMarginTokens",args:[T.usdbOutAmount],prepare:async(e,t,a)=>{let n=await t.readContract({abi:b.Wo,address:g.assetTokenAddress,functionName:"balanceOf",args:[S]}),s=n<T.usdbOutAmount?n:T.usdbOutAmount,r=await t.readContract({abi:b.Wo,address:g.assetTokenAddress,functionName:"allowance",args:[S,g.vault]});if(r<s){let e=await a.writeContract({chain:B,account:S,abi:b.Wo,address:g.assetTokenAddress,functionName:"approve",args:[g.vault,(0,f.f)("100000000000")]});await t.waitForTransactionReceipt({hash:e,confirmations:5})}return{...e,args:[s]}}}),e},[O,t,x,a,g,null==B?void 0:B.id,S]);(0,u.useEffect)(()=>{M()},[O]);let U=D==V.length,F=(0,u.useRef)(null),migrate=async()=>{try{var e;if(U)return null===(e=F.current)||void 0===e?void 0:e.click();if(P)return;console.info("tasks:",V),await E(V)}catch(e){(0,o.S3)(e)}},R=(0,d.useRouter)(),W=(0,d.usePathname)();return(0,n.jsx)(v.o,{disableOutClose:!0,style:{},open:j,onOpenChange:y,className:"backdrop-blur-lg max-w-[800px]",disableClose:C,triggerProps:{className:"shrink-0"},trigger:(0,n.jsx)("button",{className:"btn-primary mt-0",children:"MIGRATION TO V2"}),children:(0,n.jsxs)("div",{className:"card flex flex-col gap-4 !bg-transparent",children:[(0,n.jsx)("div",{className:"page-sub text-left",children:"MIGRATION TO V2"}),(0,n.jsx)("div",{children:"Before migration, make sure your USB balance is greater than your margin loan."}),w?(0,n.jsx)("div",{className:"flex justify-center items-center h-[357px]",children:(0,n.jsx)(k.$,{})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[(0,n.jsx)("div",{className:"rounded-lg overflow-x-auto w-full bg-zinc-200 dark:bg-slate-950 pb-2",children:(0,n.jsx)(simple_table,{header:["","Balance","Margin loan"],data:[["ETHx-V1",(0,c.dq)(bnGt(T.ethxTotal)),(0,n.jsx)(MarginLoan,{symbol:"USB",value:T.ethxMarginloan},"ethx_ml")],["USDBx-V1",(0,c.dq)(bnGt(T.usdbxBalance)),""],["ETH-V1",(0,c.dq)(bnGt(T.ethStaked)),""],["USB",(0,c.dq)(T.usbTotal),""]]})}),(0,n.jsxs)("div",{className:"flex flex-col pl-3 pt-5 gap-1 md:pl-5 md:pt-2",children:[(0,n.jsx)("div",{className:"text-lg",children:"Progress"}),V.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("span",{children:["- ",e.name]}),t<D&&(0,n.jsx)(m.ZSR,{className:"text-green-500"}),C&&t==D&&(0,n.jsx)(k.$,{})]},"task_"+t))]})]}),(0,n.jsxs)("button",{className:"btn-primary flex items-center gap-2 justify-center",disabled:A||C||w,onClick:migrate,children:[C&&(0,n.jsx)(k.$,{}),U&&(0,n.jsx)(m.ZSR,{className:"text-green-500"}),C?"Migrating":D==V.length?"Completed":"Start to Migration"]}),A&&(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("span",{children:"USB balance is insufficient. "}),(0,n.jsx)("span",{children:"Mint more USB from the"})," ",(0,n.jsx)("button",{className:"underline text-indigo-500 dark:text-violet-300 outline-none inline-block",onClick:()=>{var e;if("/vaults"==W)return null===(e=F.current)||void 0===e?void 0:e.click();R.push("/vaults")},children:"USDB V2 Vault"})]})]})]})})}function MigrationTip(){let e=(0,l.p)(),t=r.Lh[e],a=t&&t.length>0;return a?(0,n.jsxs)("div",{className:"flex flex-col justify-center gap-4 items-center md:flex-row",children:[(0,n.jsxs)("div",{className:"text-sm text-red-500 p-2 rounded bg-[#FFE5E0] flex items-center gap-2",children:[(0,n.jsx)("div",{className:"p-1 rounded bg-red-500",children:(0,n.jsx)(x._sk,{className:"text-white"})}),"Wand has been updated to Version2. Please ensure you complete the migration of your assets promptly."]}),(0,n.jsx)(MigrationV2,{})]}):null}},6371:function(e,t,a){a.d(t,{C:function(){return Tip}});var n=a(31113),s=a(26361),r=a(52653),l=a(66733);function Tip(e){let{children:t,node:a,className:i,inFlex:o}=e,c=document.getElementById("tooltip-root");return t?(0,n.jsx)(r.zt,{children:(0,n.jsxs)(r.fC,{children:[(0,n.jsx)(r.xz,{asChild:!0,onClickCapture:e=>{e.preventDefault(),e.stopPropagation()},children:a?(0,n.jsx)("div",{className:(0,s.cn)("inline-block cursor-default",i),style:{verticalAlign:"text-bottom"},children:a}):(0,n.jsx)("div",{className:(0,s.cn)(o?"flex":"translate-y-[-6%] inline-block"," px-[3px] cursor-default relative",i),children:(0,n.jsx)(l.apP,{className:"inline-block stroke-slate-500"})})}),(0,n.jsx)(r.h_,{container:c,children:(0,n.jsxs)(r.VY,{className:"max-w-xs text-sm text-white bg-slate-900 shadow-lg dark:bg-[#333333] rounded-md p-4",children:[t,(0,n.jsx)(r.Eh,{})]})})]})}):a}},15948:function(e,t,a){a.d(t,{n:function(){return useElementSizeCheck}});var n=a(85665);function useElementSizeCheck(e){let[t,a]=(0,n.Z)();return[t,e(a)]}},47518:function(e,t,a){a.d(t,{m:function(){return useTokenApys}});var n=a(26361),s=a(88439),r=a(45438),l=a(76034),i=a(64103),o=a(75930),c=a(59175),d=a(19757),u=a(12396);function useTokenApys(){let e=(0,s.b)(()=>(0,n.Yb)({},0n)),t=(0,c.p)(),{prices:a,usbApr:m,stableVaultsState:x}=(0,i.useContext)(o.g),p=(0,l.a)(),b=(0,r.i)();return(0,i.useMemo)(()=>{let a=d.iK[t],s=(0,n.ok)(b[a[0].ptyPoolBelowAddress],"staking");e[d.O1[t]]=m.apr,e.USB_END=m.apr+s;let r=(0,u.v)("0.1",10);return a.forEach(t=>{if(t.assetTokenAddress!=d.K8){let a=p[t.vault]>1n?(0,u.v)("".concat((p[t.vault]-1).toFixed(2)),10):0n,n=(0,u.v)("1",10);e[t.xTokenAddress]=(a*(r-x[t.vault].Y*x[t.vault].aar/n)+r*n)/n}}),null},[t,a,p,m,b,x]),e}},76034:function(e,t,a){a.d(t,{a:function(){return useValutsLeverageRatio},z:function(){return useVaultLeverageRatio}});var n=a(19757),s=a(26361),r=a(75930),l=a(64103),i=a(59175),o=a(88439);function useVaultLeverageRatio(e){let{vaultsState:t,stableVaultsState:a}=(0,l.useContext)(r.g),n=t[(null==e?void 0:e.vault)||"null"],i=a[(null==e?void 0:e.vault)||"null"],o=(null==e?void 0:e.isStable)?(0,s.pF)(i.aar,i.AARDecimals):(0,s.pF)(n.aar,n.AARDecimals);return Math.max(0,1+1/(o-1))}function useValutsLeverageRatio(){let{vaultsState:e,stableVaultsState:t}=(0,l.useContext)(r.g),a=(0,i.p)(),c=n.iK[a],d=(0,o.b)(()=>new Proxy({},{get:function(e,t){return t in e&&null!==e[t]&&void 0!==e[t]?e[t]:0}}));return c.forEach(a=>{let n=e[(null==a?void 0:a.vault)||"null"],r=t[(null==a?void 0:a.vault)||"null"],l=(null==a?void 0:a.isStable)?(0,s.pF)(r.aar,r.AARDecimals):(0,s.pF)(n.aar,n.AARDecimals);d[a.vault]=Math.max(0,1+1/(l-1))}),d}}}]);