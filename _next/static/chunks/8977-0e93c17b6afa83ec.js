(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8977],{46601:function(){},20750:function(t,e,a){"use strict";a.d(e,{aw:function(){return getBlastPoints},l3:function(){return getInviteCodes},dH:function(){return getInvitees},Vm:function(){return getPtypoolYields},Zr:function(){return getRank},V_:function(){return getUserState},M0:function(){return refreshInviteCode},n$:function(){return userLogin}});var n=a(92173),s=a(97489);let o=n.Z.create({baseURL:(s.O,"https://earlyaccess-beta.wand.fi/api"),timeout:1e4,headers:{"Content-Type":"application/json"}});var r={get:async function(t){var e;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.startsWith("/auth")){let t=localStorage.getItem("earlyaccess-token");if(!t)throw"Need token";n.headers={...n.headers||{},Authorization:t}}let s=await o.get(t,{...n,params:a});if(console.info("res:",null==s?void 0:s.data),(null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.code)!==200)throw s.data;return s.data.data},post:async function(t){var e;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.startsWith("/auth")){let t=localStorage.getItem("earlyaccess-token");if(!t)throw"Need token";n.headers={...n.headers||{},Authorization:t}}let s=await o.post(t,a,n);if((null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.code)!==200)throw s.data;return s.data.data}};let getRank=async()=>{let t=await r.get("/common/leader");return t},userLogin=async t=>{let e=await r.post("/auth/register",{code:t});return e},getUserState=async()=>{let t=await r.get("/auth/userState");return t},getBlastPoints=async()=>{let t=await r.get("/auth/blastPoints");return t},getInviteCodes=async()=>{let t=await r.get("/auth/invite/codes");return t},getInvitees=async()=>{let t=await r.get("/auth/invitees");return t},refreshInviteCode=async()=>(await r.post("/auth/invite/code/create"),getInviteCodes()),getPtypoolYields=async()=>{let t=await r.get("/common/ptypool/yields");return t}},23653:function(t,e,a){"use strict";a.d(e,{l:function(){return getTokens}});var n=a(72009);let getTokens=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return n.iK[t].map(t=>({symbol:t.assetTokenSymbol,address:t.assetTokenAddress})).concat(n.iK[t].map(t=>({symbol:t.xTokenSymbol,address:t.xTokenAddress}))).concat([{symbol:"USB",address:n.O1[t]}]).concat((n.VQ[t]||[]).map(t=>({symbol:t.assetTokenSymbol,address:t.assetToken}))).filter(t=>!e||"ETH"!==t.symbol)}},8580:function(t,e,a){"use strict";a.d(e,{Hj:function(){return s},Pq:function(){return r},pn:function(){return l},v:function(){return n},xb:function(){return o}});let n="https://twitter.com/WandProtocol",s="https://discord.gg/fy6A7JCE5N",o="https://docs.wand.fi",r=BigInt(1e18),l=864e5},23862:function(t,e,a){"use strict";a.d(e,{b:function(){return useMemoOfChainId}});var n=a(2265),s=a(14389);function useMemoOfChainId(t){let e=(0,s.p)(),a=(0,n.useRef)({});return(0,n.useMemo)(()=>(a.current[e]||(a.current[e]=t()),a.current[e]),[e])}},86825:function(t,e,a){"use strict";a.d(e,{i:function(){return i},p:function(){return useUpdatePtypoolApy}});var n=a(72009),s=a(8580),o=a(2265),r=a(43977),l=a(74738),u=a(14389);let i=(0,l.Ue)(t=>({update:t}));function useUpdatePtypoolApy(t,e,a){let l=(0,u.p)(),d=n.iK[l],c=Object.values(t).reduce((t,e)=>e.totalStake+t,0n),{update:b}=i();(0,o.useEffect)(()=>{d.forEach(o=>{let u=a[o.vault];if(o.ptyPoolAboveAddress&&t[o.ptyPoolAboveAddress]&&b({[o.ptyPoolAboveAddress]:{staking:(0,r.v)("0.025",10),matching:0n}}),o.ptyPoolBelowAddress&&t[o.ptyPoolBelowAddress]){let a=t[o.ptyPoolBelowAddress].totalStake*e[n.O1[l]];console.info("hhh:",a);let r=a>0n&&u.settingsDecimals>0n?u.M_ETHx*u.Y*e[o.xTokenAddress]*s.Pq/2n/a/u.settingsDecimals**10n:0n;b({[o.ptyPoolBelowAddress]:{staking:r*10n**10n/s.Pq,matching:0n}})}})},[d,c,t,e,a])}},47868:function(t,e,a){"use strict";a.d(e,{g:function(){return w},A:function(){return FetcherProvider}});var n=a(57437),s=a(72189),o=a(20750),r=a(72009),l=a(23653),u=a(8580),i=a(14389),d=a(2265),c=a(56926),b=a(32699),m=a(93362),p=a(91056),v=a(23862),f=a(54415),h=a(81628),g=a(86825),k=a(2890),S=a.n(k),y=a(38092),A=a(21693),Y=a(16775),T=a(7935);let w=(0,d.createContext)({balances:(0,h.Yb)({},0n),totalSupplies:(0,h.Yb)({},0n),prices:(0,h.Yb)({},0n),assetLocked:(0,h.Yb)({},0n),aar:(0,h.Yb)({},0),vaultUSBTotal:(0,h.Yb)({},0n),vaultsMode:(0,h.Yb)({},0),vaultsDiscount:(0,h.Yb)({},!1),vaultsState:(0,h.Yb)({},(0,h.Yb)({},0n)),stableVaultsState:(0,h.Yb)({},(0,h.Yb)({},0n)),earns:(0,h.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10},plainVaultsStat:(0,h.Yb)({},(0,h.Yb)({},0n))}),FetcherProvider=t=>{let{children:e}=t,a=(0,i.p)();!function(){let{chainId:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,c.t_)({chainId:t});d.useMemo(()=>{let t=function(t){var e,a;let{chain:n,transport:s}=t,o={chainId:n.id,name:n.name,ensAddress:null===(a=n.contracts)||void 0===a?void 0:null===(e=a.ensRegistry)||void 0===e?void 0:e.address};return"fallback"===s.type?new b.H(s.transports.map(t=>{let{value:e}=t;return new m.r(null==e?void 0:e.url,o)})):new m.r(s.url,o)}(e);return p.ON.provider=t,t},[e])}();let{address:k}=(0,c.mA)(),{data:P}=(0,c.KQ)({address:k,enabled:!!k,chainId:a}),B=(0,d.useMemo)(()=>(0,l.l)(a),[a]),{data:N}=(0,f.uX)({contracts:[...B.map(t=>({address:t.address,abi:T.em,functionName:"balanceOf",args:[k],chainId:a}))],enabled:!!k}),{data:M}=(0,f.uX)({contracts:[...B.map(t=>({address:t.address,abi:T.em,functionName:"totalSupply",chainId:a}))]}),U=(0,v.b)(()=>(0,h.Yb)({},0n));U[r.K8]=(null==P?void 0:P.value)||0n,B.forEach((t,e)=>{U[t.address]=(0,h.ok)(N,[e,"result"])});let _=(0,v.b)(()=>(0,h.Yb)({},0n));B.forEach((t,e)=>{_[t.address]=(0,h.ok)(M,[e,"result"])});let C=r.iK[a],E=function(){let t=(0,i.p)(),e=r.iK[t],{data:a}=(0,f.uX)({contracts:[...e.map(t=>({vc:t,abi:s.nq,address:t.assetTokenFeed,functionName:"latestPrice"}))]}),{data:n}=(0,f.uX)({cacheTime:u.pn,contracts:[...e.map(t=>({abi:s.nq,address:t.assetTokenFeed,functionName:"decimals"}))]});return(0,d.useMemo)(()=>{let t={};return e.forEach((e,s)=>{let o=(0,h.ok)(a,[s,"result"]),r=(0,h.ok)(n,[s,"result"]);t[e.assetTokenAddress]=[o,r]}),t},[a,n,e])}(),{data:I}=(0,f.uX)({contracts:[...C.map(t=>({vc:t,abi:s.WW,address:t.vault,functionName:"assetBalance"}))]}),{data:W}=(0,f.uX)({contracts:[...C.map(t=>({abi:s.WW,address:t.vault,functionName:"usbTotalSupply"}))]}),{data:D}=(0,f.uX)({contracts:[...C.map(t=>({vc:t,abi:s.Wn,address:r.O6[a],functionName:"AAR",args:[t.vault]}))]}),{data:X}=(0,f.uX)({cacheTime:u.pn,contracts:[...C.map(t=>({abi:s.WW,address:t.vault,functionName:"AARDecimals"}))]}),{data:O}=(0,f.uX)({contracts:[...C.map(t=>({abi:s.WW,address:t.vault,functionName:"vaultMode"}))]}),{data:x}=(0,f.uX)({contracts:[...C.map(t=>({vc:t,abi:s.Wn,address:r.O6[a],functionName:t.isStable?"getStableVaultState":"getVaultState",args:[t.vault]}))]}),{data:R}=(0,f.uX)({cacheTime:u.pn,contracts:[...C.map(t=>({vc:t,abi:s.WW,address:t.vault,functionName:"paramValue",args:[(0,A.$G)("Y",{size:32})]}))]}),V=(0,v.b)(()=>(0,h.Yb)({[r.O1[a]]:u.Pq},0n)),q=(0,v.b)(()=>(0,h.Yb)({},0n)),K=(0,v.b)(()=>(0,h.Yb)({},0n)),H=(0,v.b)(()=>(0,h.Yb)({},0n)),F=(0,v.b)(()=>(0,h.Yb)({},0)),L=(0,v.b)(()=>(0,h.Yb)({},(0,h.Yb)({},0n))),j=(0,v.b)(()=>(0,h.Yb)({},(0,h.Yb)({},0n))),z=function(t,e,a){let n=(0,v.b)(()=>(0,h.Yb)({},!1)),o=(0,i.p)(),l=r.iK[o],{data:u}=(0,f.uX)({contracts:l.map(t=>({vc:t,abi:s.WW,address:t.vault,functionName:"paramValue",args:[(0,A.$G)("CircuitBreakPeriod",{size:32})]}))});return l.forEach((s,o)=>{if(s.isStable){let t=e[(null==s?void 0:s.vault)||"null"];n[s.vault]=t&&t.M_USDCx>0n&&t.aar<t.AARS}else{let e=(0,h.ok)(u,[o,"result"]),r=t[(null==s?void 0:s.vault)||"null"],l=a[(null==s?void 0:s.vault)||"null"],i=(0,h.ok)(r,"AARBelowCircuitBreakerLineTime"),d=2==l&&r&&((0,h.ok)(r,"aar")>=(0,h.ok)(r,"AARC")||BigInt(Math.floor(new Date().getTime()/1e3))-i>=e);n[s.vault]=d}}),n}(L,j,F);C.forEach((t,e)=>{var n,s,o;let l=(0,h.ok)(I,[e,"result"]),i=(0,h.ok)(W,[e,"result"]),d=(0,h.ok)(E[t.assetTokenAddress],[0]),c=(0,h.ok)(E[t.assetTokenAddress],[1]);H[t.vault]=i;let b=c>0n?d*u.Pq/10n**c:0n;V[t.assetTokenAddress]=b;let m=_[t.xTokenAddress],p=m>0n&&l>0n&&b>0n&&i>0n&&l*b>i*u.Pq?(l*b-i*u.Pq)/m:0n;m>0n&&l>0n&&b>0n&&i>0n&&l*b<i*u.Pq&&(V[r.O1[a]]=l*b/i),V[t.xTokenAddress]=p,q[t.assetTokenAddress]=l;let v=(0,Y.b)((0,h.ok)(D,[e,"result"]),parseInt((0,h.ok)(X,[e,"result"]).toString()));K[t.vault]=parseFloat(v),t.isStable?j[t.vault]=(0,h.Yb)({settingsDecimals:10n,...null==x?void 0:null===(s=x[e])||void 0===s?void 0:s.result,Y:(0,h.ok)(R,[e,"result"])},0n):L[t.vault]=(0,h.Yb)({settingsDecimals:10n,...null==x?void 0:null===(o=x[e])||void 0===o?void 0:o.result,Y:(0,h.ok)(R,[e,"result"])},0n);let f=j[t.vault];F[t.vault]=t.isStable?f.aar<f.AARS&&f.M_USDC>0n?2:1:(null==O?void 0:null===(n=O[e])||void 0===n?void 0:n.result)||0});let Q=function(){let{address:t}=(0,c.mA)(),e=(0,i.p)(),a=(0,d.useMemo)(()=>r.iK[e].filter(t=>!t.isStable&&t.ptyPoolAboveAddress&&t.ptyPoolBelowAddress).map(t=>[{poolAddress:t.ptyPoolBelowAddress,stakeSymbol:"USB",matchSymbol:t.assetTokenSymbol,earnSymbol:t.xTokenSymbol,earnForMatchSymbol:t.assetTokenSymbol},{poolAddress:t.ptyPoolAboveAddress,stakeSymbol:t.assetTokenSymbol,matchSymbol:"USB",earnSymbol:t.assetTokenSymbol,earnForMatchSymbol:t.xTokenSymbol}]).flat(),[e]),{data:n}=(0,f.uX)({enabled:!!t,contracts:[...a.map(e=>{let{poolAddress:a}=e;return{abi:s.aT,address:a,functionName:"userStakingBalance",args:[t]}}),...a.map(e=>{let{poolAddress:a}=e;return{abi:s.aT,address:a,functionName:"earnedMatchedToken",args:[t]}}),...a.map(e=>{let{poolAddress:a}=e;return{abi:s.aT,address:a,functionName:"earnedStakingYields",args:[t]}}),...a.map(e=>{let{poolAddress:a}=e;return{abi:s.aT,address:a,functionName:"earnedMatchingYields",args:[t]}})]}),{data:o}=(0,f.uX)({contracts:[...a.map(t=>{let{poolAddress:e}=t;return{abi:s.aT,address:e,functionName:"totalStakingBalance"}})]}),l=(0,v.b)(()=>(0,h.Yb)({},(0,h.Yb)({},0n)));return a.forEach((t,e)=>{let{poolAddress:s,stakeSymbol:r,matchSymbol:u,earnSymbol:i}=t,d=(0,h.ok)(n,[e,"result"]),c=(0,h.ok)(n,[e+a.length,"result"]),b=(0,h.ok)(n,[e+2*a.length,"result"]),m=(0,h.ok)(n,[e+3*a.length,"result"]),p=(0,h.ok)(o,[e,"result"]);l[s]={stakeSymbol:r,matchSymbol:u,earnSymbol:i,stake:d,match:c,earn:b,earnForMatch:m,totalStake:p}}),l}(),Z=function(t,e){let a=(0,i.p)(),n=0,s=0n,o=0n;return r.iK[a].forEach(a=>{if(a.isStable){let t=e[a.vault];s+=t.M_USB_USDC*t.Y*t.aar/10n**t.AARDecimals,o+=t.M_USB_USDC,t.M_USB_USDC>0n&&t.Y>0n&&n++}else{let e=t[a.vault];s+=e.M_USB_ETH*e.Y,o+=e.M_USB_ETH,e.M_USB_ETH>0n&&e.Y>0n&&n++}}),{apr:o>0n?s/o:0n,aprDecimals:10}}(L,j);(0,d.useEffect)(()=>{setInterval(()=>{let t=f.hp.getState();S().now()-t.time>=36e5&&t.update()},36e5)},[]);let $=(0,f.hp)(),{value:G={}}=(0,y.Z)(o.Vm,[$.time]);(0,g.p)(Q,V,L);let J=function(){let t=(0,i.p)(),{address:e}=(0,c.mA)(),a=r.VQ[t]||[],{data:n}=(0,f.uX)({contracts:[...a.map(t=>({abi:s.a4,address:t.vault,functionName:"totalSupply"})),...a.map(t=>({abi:s.a4,address:t.vault,functionName:"balanceOf",args:[e]}))]}),o=(0,v.b)(()=>(0,h.Yb)({},(0,h.Yb)({},0n)));return a.forEach((t,e)=>{o[t.vault]=o[t.vault],o[t.vault].totalSupply=(0,h.ok)(n,[e,"result"]),o[t.vault].userStaked=(0,h.ok)(n,[e+a.length,"result"])}),o}();return(0,n.jsx)(w.Provider,{value:{balances:U,totalSupplies:_,prices:V,assetLocked:q,aar:K,vaultUSBTotal:H,vaultsMode:F,vaultsDiscount:z,vaultsState:L,stableVaultsState:j,earns:Q,usbApr:Z,ptypoolYields:G,plainVaultsStat:J},children:e})}}}]);