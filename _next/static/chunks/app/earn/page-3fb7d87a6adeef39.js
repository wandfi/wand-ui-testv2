(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{14034:function(e,s,a){"use strict";a.d(s,{Z:function(){return o}});var t=a(50044),l=a(2265),n=a(16737),r=a(37517),i=a(93568),d=a(76503);let c=(0,i.fn)("Divider"),o=l.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.__rest)(e,["className"]);return l.createElement("div",Object.assign({ref:s,className:(0,d.q)(c("root"),"w-full mx-auto","bg-tremor-background-subtle","dark:bg-dark-tremor-background-subtle",n.N.threeXs.height,r.W.threeXl.marginTop,r.W.threeXl.marginBottom,a)},i))});o.displayName="Divider"},62166:function(e,s,a){Promise.resolve().then(a.bind(a,9460))},9460:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return EarnPage}});var t=a(57437),l=a(82265),n=a(72009),r=a(8580),i=a(14389),d=a(86825),c=a(2265);let o={};var m=a(54415),u=a(43003),x=a(81628),h=a(47868),p=a(20373),b=a(14034),k=a(87456),f=a(57042),v=a(16691),j=a.n(v),g=a(79352),T=a(79037),y=a(76036),N=a(34776),w=a(80547),A=a(51549),S=a(72084),_=a(64020),E=a(8332),R=a(47960),P=a(21817);function WrapDiv(e){let{children:s,wrap:a,...l}=e;return a?(0,t.jsx)("div",{...l,children:s}):s}function TokenValue(e){let{symbol:s,value:a,decimals:l}=e;return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(j(),{className:"inline-block",alt:"usb",width:16,height:16,src:"/".concat(s,".svg")}),(0,p.dq)(a,l)]})}function DualTokenCard(e){let{type:s,vc:a}=e,v="buy"==s,j=(0,i.p)(),D=v?n.O1[j]:a.assetTokenAddress,M=v?a.assetTokenAddress:a.xTokenAddress,q=v?"USB":a.assetTokenSymbol,C=v?a.assetTokenSymbol:"USB",B=v?"Buy ".concat(a.assetTokenSymbol," Low"):"Sell ".concat(a.assetTokenSymbol," High"),H=v?a.ptyPoolBelowAddress:a.ptyPoolAboveAddress,{prices:z,balances:U,earns:F,vaultsState:V,assetLocked:Z,vaultUSBTotal:I,usbApr:J}=(0,c.useContext)(h.g),W=V[a.vault],Y=F[H],{address:L}=(0,T.m)(),O=U[D],[G,X]=(0,c.useState)(""),$=(0,x.su)(G),K=v?a.xTokenSymbol:a.assetTokenSymbol,Q=v?a.assetTokenSymbol:a.xTokenSymbol;(0,c.useMemo)(()=>Y.totalStake*(0,x.ok)(z,D,r.Pq)/r.Pq,[z[D],Y.totalStake]);let ee=v?null==W?void 0:W.AARS:null==W?void 0:W.AARU,es=(0,x.ok)(Z,a.assetTokenAddress),ea=(0,x.ok)(I,a.vault),et=(0,c.useMemo)(()=>ee&&W.AARDecimals&&0n!=es&&0n!=ea?ee*ea*r.Pq/W.AARDecimals/es/BigInt(1e9):(0,x.ok)(z,a.assetTokenAddress),[ee,ea,W.AARDecimals,es]),el=v?"Stake $USB, and when the ".concat(a.assetTokenSymbol," price falls to the target, it will trigger the purchase of ").concat(a.assetTokenSymbol," with staked $USB."):"Stake ".concat(a.assetTokenSymbol,", and when the ").concat(a.assetTokenSymbol," price rises to the target, staked ").concat(a.assetTokenSymbol," will be sold."),en=(0,m.D2)({abi:l.aT,address:H,functionName:"getAccruedMatchingYields"}),er=(0,x.ok)(en,"data"),ei=(0,c.useMemo)(()=>{let e=(0,x.ok)(Y,"totalStake");if(0n==e||0n==z[D])return"0.00%";let s=10n**(W.AARDecimals||10n),a=(W.AART-s)*et;if(0n==a)return"0.00%";let t=v?(W.AART*W.M_USB_ETH*r.Pq-W.M_ETH*et*s)/(W.AART-s)/r.Pq:(W.M_ETH*et*s-W.AART*W.M_USB_ETH*r.Pq)/a;return e=(0,x.NA)([e,t]),(0,x.Jh)(er*z[M]*r.Pq/(e*z[D]),18,3)},[Y.totalStake,er,M,D,z[M],z[D],v]),ed=(0,d.i)(),ec=(0,x.ok)(ed[H],"staking"),eo=z[a.assetTokenAddress]>0&&et>0n?v?(z[a.assetTokenAddress]-et)*10n**10n/z[a.assetTokenAddress]:(et-z[a.assetTokenAddress])*10n**10n/z[a.assetTokenAddress]:0n,em=(0,c.useMemo)(()=>{let e=10n**(W.AARDecimals||10n),s=(W.AART-e)*et/e;if(0n==s)return 0n;if(v){let a=(W.AART*W.M_USB_ETH*r.Pq-W.M_ETH*et*e)/e/s,t=a*et/r.Pq,l=Y.stake,n=Y.totalStake>t&&t>=0n?l*t/Y.totalStake:l;return n}{let a=(W.M_ETH*et*e-W.AART*W.M_USB_ETH*r.Pq)/e/s,t=Y.stake,l=Y.totalStake>a&&a>=0n?t*a/Y.totalStake:t;return l}},[Y,W,v,et]),eu=(0,c.useMemo)(()=>{let e=v?[{key:"eth_price",label:"ETH Price",value:(0,p.dq)(z[a.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,t.jsxs)("div",{children:[(0,p.dq)(et),"(",(0,t.jsxs)("span",{className:"text-red-600",children:["-",(0,x.Jh)(eo,10)]}),")"]}),groupEnd:!0},{key:"apr_interest",label:"APY",value:(0,x.Jh)(J.apr+ec,J.aprDecimals,2),detail:(0,t.jsxs)("div",{className:"pl-2",children:[(0,t.jsxs)("div",{children:["~USB Interest: ",(0,x.Jh)(J.apr,J.aprDecimals,2)]}),(0,t.jsxs)("div",{children:["~",K," Yield: ",(0,x.Jh)(ec,J.aprDecimals,2)]})]}),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,t.jsx)(TokenValue,{symbol:Q,value:er})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(ei," (Est.)")}]:[{key:"eth_price",label:"ETH Price",value:(0,p.dq)(z[a.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,t.jsxs)("div",{children:[(0,p.dq)(et),"(",(0,t.jsxs)("span",{className:"text-green-600",children:["+",(0,x.Jh)(eo,10)]}),")"]}),groupEnd:!0},{key:"apr_yield",label:"APY(".concat(K," Yield)"),value:(0,x.Jh)(ec,J.aprDecimals,2),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a sell action is triggered, these funds will be distributed proportionally.",value:(0,t.jsx)(TokenValue,{symbol:Q,value:er})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(ei," (Est.)")}];return e},[Y,er]),ex=(0,c.useMemo)(()=>{let e=v?[{key:"successfully_brought",label:"Successfully Bought",value:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(TokenValue,{symbol:C,value:Y.match}),(0,t.jsx)("span",{children:"+"}),(0,t.jsx)(TokenValue,{symbol:Q,value:Y.earnForMatch}),(0,t.jsx)(_.C,{inFlex:!0,children:"From Reward Pool"})]})},{key:"staking_earend",label:"".concat(K," Earned"),value:(0,t.jsx)(TokenValue,{symbol:K,value:Y.earn})}]:[{key:"successfully_sold",label:"Successfully Sold",value:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(TokenValue,{symbol:C,value:Y.match}),(0,t.jsx)("span",{children:"+"}),(0,t.jsx)(TokenValue,{symbol:Q,value:Y.earnForMatch}),(0,t.jsx)(_.C,{inFlex:!0,children:"From Reward Pool"})]})}];return e},[Y,C,K,Q]),{write:eh,isDisabled:ep,isLoading:eb}=(0,u.R)({abi:l.aT,address:H,functionName:"claimAll"}),ek=function(e){let s=(0,c.useRef)(null);return o[e]&&o[e].includes(s)||(o[e]=[...o[e]||[],s]),(0,c.useEffect)(()=>{if(!s.current)return()=>{};let onResize=()=>{let a=o[e]||[],t=a.reduce((e,s)=>{var a;return Math.max((null===(a=s.current)||void 0===a?void 0:a.clientHeight)||0,e)},0);a.filter(e=>e!=s).forEach(e=>{var s;let a=(null===(s=e.current)||void 0===s?void 0:s.clientHeight)||0;a!==t&&t>0&&e.current&&(e.current.style.height="".concat(t,"px"))})};return window.addEventListener("resize",onResize),onResize(),()=>{window.removeEventListener("resize",onResize)}},[s.current]),s}(a.vault),ef=(0,E.IS)();ef.find(e=>e.symbol==q);let[ev,ej]=(0,P.n)(e=>{let{width:s}=e;return s<512});return(0,t.jsxs)("div",{className:"card flex flex-col",ref:ev,children:[(0,t.jsxs)("div",{className:"flex gap-5 items-center justify-between",ref:ek,children:[(0,t.jsxs)("div",{className:"flex gap-3 md:gap-5 items-center",children:[(0,t.jsxs)("div",{className:"relative w-fit shrink-0",children:[(0,t.jsx)(A.c,{size:32,symbol:q,className:"md:hidden"}),(0,t.jsx)(A.c,{size:40,symbol:q,className:"hidden md:block"}),(0,t.jsx)(A.c,{size:16,symbol:C,className:"absolute -right-1 -bottom-1 md:hidden"}),(0,t.jsx)(A.c,{size:24,symbol:C,className:"absolute -right-2 -bottom-2 hidden md:block"})]}),(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("h6",{className:"page-sub",children:B||"title"}),(0,t.jsx)(_.C,{children:el})]})})]}),(0,t.jsxs)(WrapDiv,{wrap:ej,className:"flex flex-col-reverse gap-1 items-end",children:[(0,t.jsx)(R._,{icons:["blast","gold","wand"]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-xs text-black font-medium text-right",children:["Total ",q," Staked"]}),(0,t.jsx)("div",{className:"text-base text-black text-end font-semibold",children:(0,p.dq)(Y.totalStake)})]})]})]}),(0,t.jsx)(b.Z,{className:"my-4"}),(0,t.jsxs)(k.Z,{numItemsSm:2,className:"gap-x-2 flex-1",children:[(0,t.jsx)(k.Z,{numItemsSm:1,className:"gap-y-2 gap-x-7 md:border-r-[1px] border-[#E4E4E7] mb-3 md:mb-0 ",children:null==eu?void 0:eu.map(e=>(0,t.jsxs)("div",{className:(0,f.Z)("flex flex-col text-sm",{"mb-4":e.groupEnd}),children:[(0,t.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,t.jsxs)("div",{className:"text-black font-medium mr-[5px]",children:[e.label," : ",e.tip&&(0,t.jsx)(_.C,{children:e.tip})]}),(0,t.jsx)("div",{className:"text-neutral-900 ml-2",children:e.value})]}),e.detail]},e.key))}),L&&(0,t.jsxs)(k.Z,{numItemsSm:1,className:"gap-x-1",children:[(0,t.jsx)("div",{className:"w-full border-t-[1px] border-[#E4E4E7] md:border-0 md:px-[0px]",children:null==ex?void 0:ex.map(e=>(0,t.jsxs)("div",{className:"flex items-center flex-wrap mt-[8px] md:mt-0 md:mb-2",children:[(0,t.jsxs)("div",{className:"text-xs text-black whitespace-nowrap font-medium mr-[5px]",children:[e.label," :"]}),(0,t.jsx)("div",{className:"text-neutral-900 text-sm shrink-0 ml-2",children:e.value})]},e.key))}),(0,t.jsxs)("div",{className:"mt-auto h-fit",children:[(0,t.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,t.jsxs)("button",{className:"btn-primary px-4 h-7 flex items-center w-[60%] md:w-fit self-end justify-center gap-4 bg-[#64738B]",disabled:ep||eb,onClick:()=>eh(),children:[eb&&(0,t.jsx)(S.$,{}),"Claim All"]})}),(0,t.jsxs)("div",{className:"relative flex flex-col gap-1 mt-4 md:mt-[28px] justify-center items-center text-[#64748B] text-sm font-medium p-3 rounded-md bg-slate-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:["Staked",(0,t.jsx)(A.c,{symbol:q,size:16}),(0,p.dq)(Y.stake),(0,t.jsx)("span",{className:"text-[#6466F1] ml-[5px] cursor-pointer",onClick:()=>X((0,g.d)(Y.stake)),children:"Max"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 pl-8",children:["-",(0,p.dq)(em),(0,t.jsxs)(_.C,{inFlex:!0,children:["This is the amount of staked ",q," that will be ",v?"spent":"sold"," when price triggers."]})]})]})]})]})]}),L?(0,t.jsxs)("div",{className:"mt-4 md:mt-[30px]",children:[(0,t.jsx)(w.W,{amount:G,setAmount:X,asset:q,balance:O,checkBalance:!1}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(y.v,{tx:"Stake",disabled:$<=0n||$>O,onTxSuccess:()=>{X("")},config:{abi:l.aT,address:H,functionName:"stake",args:[$],value:"ETH"==q?$:0n},className:"mt-2 w-[45%]",approves:{[D]:$},spender:H}),(0,t.jsx)(y.v,{className:"mt-2 w-[45%]",tx:"Withdraw",disabled:$<=0n||$>Y.stake,onTxSuccess:()=>{X("")},config:{abi:l.aT,address:H,functionName:"withdraw",args:[$]}})]})]}):(0,t.jsx)("div",{className:"w-full flex items-center justify-center mt-[30px]",children:(0,t.jsx)(N.Z,{})})]})}function GroupDualTokenCard(e){let{vcs:s,type:a}=e,[l,n]=(0,c.useState)(s[s.length-1]);return 0==s.length?null:1==s.length?(0,t.jsx)(DualTokenCard,{vc:s[0],type:a}):(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(DualTokenCard,{vc:l,type:a}),(0,t.jsx)("div",{className:"absolute z-10 left-[86px] top-0 flex text-sm",children:s.map((e,s)=>(0,t.jsx)("div",{className:(0,f.Z)("cursor-pointer rounded-b-full border border-blue-500 px-1 py-1",{"bg-white text-black":l!==e,"bg-blue-500 text-white":l===e}),onClick:()=>n(e),children:"V".concat(s+1)},"gdtc_"+s))})]})}var D=a(63040),M=a(55139);function EarnPage(){let e=(0,i.p)(),s=(0,c.useMemo)(()=>n.iK[e].filter(e=>!e.isStable),[e]);return(0,t.jsxs)("div",{className:"w-full h-full max-w-screen-xl px-4 mx-auto",children:[(0,t.jsx)(D.a,{}),(0,t.jsx)("h2",{className:"page-title",children:"Price Trigger Yield"}),(0,t.jsx)(M.r,{numItemsMd:2,className:"gap-3 mt-4",children:s.map((e,s)=>(0,t.jsxs)(c.Fragment,{children:[(0,t.jsx)(GroupDualTokenCard,{vcs:[e],type:"buy"}),(0,t.jsx)(GroupDualTokenCard,{vcs:[e],type:"sell"})]},"dual_card_group_".concat(s)))})]})}}},function(e){e.O(0,[1866,9472,1787,6169,1582,2400,6682,498,7647,6107,5668,590,5224,7744,6128,5077,8977,4320,9625,2971,2472,1744],function(){return e(e.s=62166)}),_N_E=e.O()}]);