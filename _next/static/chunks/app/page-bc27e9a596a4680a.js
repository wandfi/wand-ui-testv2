(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{30786:function(e,t,a){Promise.resolve().then(a.bind(a,86247))},86247:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var l=a(31113),s=a(19757),n=a(44769),i=a(59175),r=a(68535),o=a(22139),d=a(64370),u=a(77503),c=a(6069),m=a(17370),x=a(22298),f=a(53060);let h=(0,u.v)({transport:(0,c.d)("https://rpc.ankr.com/story_mainnet")}),v=(0,m.V)(["function assetBalance() public view returns (uint256)"]);async function getAssetAmoutBy(e,t){try{return await h.readContract({abi:v,address:e,functionName:"assetBalance"})}catch(a){return h.readContract({abi:x.Wo,address:t,functionName:"balanceOf",args:[e]})}}var g=a(5035),p=a(47518),b=a(84944),y=a(41690),w=a.n(y),k=a(60900);function Home(){let e=(0,i.p)(),{tvl:t}=(0,g.w)(),a=(0,g.R)(),{data:u}=(0,d.a)({queryKey:["storyTVL"],gcTime:36e5,initialData:0n,queryFn:async()=>{let[e,t]=await Promise.all([(0,r.LJ)(["IP"]),getAssetAmoutBy("0x72b3f85D0f1d05af9ea733DB3AD15d0ba9cB47b5","0x5267F7eE069CEB3D8F1c760c215569b79d0685aD")]),a=e[0].price,l=a*t/o.Pq;return console.info("story tvl:",(0,f.d)(l)),l}});(0,p.m)();let c=s.iK[e];return c.find(e=>"USDB"==e.assetTokenSymbol),(0,l.jsxs)("div",{className:"flex max-w-screen-xl mx-auto px-4 flex-col h-[calc(100vh-100px)] items-center pb-8",children:[(0,l.jsxs)("div",{className:"flex items-center mb-6 gap-2",children:[(0,l.jsx)(k.RSW,{className:"text-[#ff0000] text-lg"})," ",(0,l.jsx)("a",{href:"https://story.".concat(n.Kh.value),className:"underline underline-offset-[3px]",children:"Wand is now live on Story Mainnet"})]}),(0,l.jsxs)("h1",{className:"flex md:px-8 text-[min(6vw,1.875rem)] font-extrabold text-slate-700 dark:text-slate-50 text-center",children:[(0,l.jsx)("svg",{className:"mr-2 animate-bounce self-end shrink-0",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M8 0C9.37146 3.70633 12.2937 6.62854 16 8C12.2937 9.37146 9.37146 12.2937 8 16C6.62854 12.2937 3.70633 9.37146 0 8C3.70633 6.62854 6.62854 3.70633 8 0Z",fill:"#10B981"})}),"A Structured Protocol for",(0,l.jsx)("br",{})," Better Asset Utilization",(0,l.jsx)("svg",{className:"ml-2 animate-bounce shrink-0",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M8 0C9.37146 3.70633 12.2937 6.62854 16 8C12.2937 9.37146 9.37146 12.2937 8 16C6.62854 12.2937 3.70633 9.37146 0 8C3.70633 6.62854 6.62854 3.70633 8 0Z",fill:"#6366F1"})})]}),(0,l.jsxs)("div",{className:"relative flex-1 w-full md:bg-white mt-6 flex flex-col sm:flex-row gap-2 md:p-2 text-2xl rounded-2xl text-white",children:[(0,l.jsx)("img",{src:"./balance.png",style:{aspectRatio:"524/600"},className:"object-fill w-full h-auto max-w-[270px] md:max-w-[350px] absolute z-10 top-[44%] md:top-1/2 right-0 left-1/2 -translate-x-1/2 -translate-y-1/2"}),(0,l.jsxs)("div",{className:"min-h-[240px] md:min-h-[400px] relative bg-emerald-500 overflow-hidden flex-1 p-4 md:pt-10 md:px-7 rounded-xl",children:[(0,l.jsx)("div",{className:"p-2 bg-white rounded-2xl w-fit",children:(0,l.jsx)(w(),{alt:"riskoff",width:48,height:48,src:"/riskoff.svg"})}),(0,l.jsx)("h3",{className:"font-bold text-2xl mt-3 lg:text-2xl",children:"Risk Off"}),(0,l.jsxs)("div",{className:"text-sm lg:text-lg relative z-20 mt-4 !leading-tight",children:["Stable Coin",(0,l.jsx)("br",{}),"Principal Token"]})]}),(0,l.jsxs)("div",{className:"min-h-[480px] relative overflow-hidden bg-indigo-500 text-right justify-end items-end flex flex-col flex-1 p-4 md:pb-10 md:px-7 rounded-xl",children:[(0,l.jsx)("div",{className:"p-2 bg-white rounded-2xl w-fit flex gap-1 z-50",children:(0,l.jsx)(w(),{alt:"USB",width:48,height:48,src:"/riskon.svg"})}),(0,l.jsx)("span",{className:"font-bold text-lg mt-3 lg:text-2xl relative z-10",children:"Risk On"}),(0,l.jsxs)("div",{className:"text-sm lg:text-lg mt-4 !leading-tight",children:["Margin Token",(0,l.jsx)("br",{}),"Yield Token"]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-12 absolute -right-16 -top-48 rounded-full items-center justify-center",style:{transform:"rotateX(60deg) rotateY(0deg) rotateZ(-45deg)"},children:[(0,l.jsx)(w(),{width:384,height:384,src:"/ETH.svg",alt:"ETH",className:"relative left-1/4 grayscale mix-blend-luminosity opacity-20 col-span-2"}),(0,l.jsx)(w(),{width:384,height:384,src:"/WBTC.svg",alt:"WBTC",className:"mix-blend-luminosity opacity-20 grayscale"}),(0,l.jsx)(w(),{width:384,height:384,src:"/stETH.svg",alt:"WBTC",className:"mix-blend-luminosity opacity-20 grayscale"})]})]})]}),(0,l.jsxs)("div",{className:"w-full px-4 pb-8 md:pt-8 text-3xl font-extrabold text-slate-700 dark:text-slate-50",children:[(0,l.jsx)("span",{className:"text-lg whitespace-nowrap",children:"Total Value Locked:"})," $",(0,b.dq)(t+a+u)]})]})}},5035:function(e,t,a){"use strict";a.d(t,{R:function(){return useTVLV1},w:function(){return useTVL}});var l=a(19757),s=a(59175),n=a(64103),i=a(75930),r=a(22139),o=a(15506),d=a(26504),u=a(26361);function useTVLV1(){var e,t;let a=(0,s.p)(),c=null===(e=l.Lh[a])||void 0===e?void 0:e[0],m=null===(t=l.Lh[a])||void 0===t?void 0:t[1],{prices:x}=(0,n.useContext)(i.g),{data:f}=(0,o.uX)({contracts:[{abi:d.Wn,address:l.O6[a],functionName:"getVaultState",args:[null==c?void 0:c.vault]},{abi:d.Wn,address:l.O6[a],functionName:"getStableVaultState",args:[null==m?void 0:m.vault]},{abi:d.aT,address:null==c?void 0:c.ptyPoolAboveAddress,functionName:"totalStakingBalance"}]}),h=(0,u.ok)(f,[0,"result","M_ETH"]),v=(0,u.ok)(f,[1,"result","M_USDC"]),g=(0,u.ok)(f,[2,"result"]);return(h+g)*x[l.K8]/r.Pq+v*x[null==m?void 0:m.assetTokenAddress]/r.Pq}function useTVL(){let e=(0,s.p)(),t=l.iK[e],a=l.VQ[e]||[],{earns:o,prices:d,totalSupplies:u,vaultUSBTotal:c,plainVaultsStat:m}=(0,n.useContext)(i.g),x=t.map(e=>c[e.vault]).reduce((e,t)=>e+t,0n),f=[{name:"USB",symbol:"USB",address:l.O1[e]}].concat(t.map(e=>({name:e.xTokenSymbol+e.version,symbol:e.xTokenSymbol,address:e.xTokenAddress}))).map(e=>{let t=d[e.address],a="USB"==e.symbol?x:u[e.address],l=t*a/r.Pq;return{...e,price:t,amount:a,usdAmount:l}}).concat(t.filter(e=>!e.isStable).map(e=>{console.info("earns:",o[e.ptyPoolAboveAddress]);let t=o[e.ptyPoolAboveAddress].totalStake+o[e.ptyPoolBelowAddress].balance,a=d[e.assetTokenAddress],l=a*t/r.Pq;return{name:e.assetTokenSymbol+e.version,symbol:e.assetTokenSymbol,address:e.assetTokenAddress,price:a,amount:t,usdAmount:l}})).concat(a.map(e=>{let t=d[e.assetToken],a=m[e.vault].totalSupply,l=t*a/r.Pq;return{name:e.assetTokenSymbol,symbol:e.assetTokenSymbol,address:e.assetToken,price:t,amount:a,usdAmount:l}})),h=f.reduce((e,t)=>e+t.usdAmount,0n);return{tvl:h,tvlItems:f}}},47518:function(e,t,a){"use strict";a.d(t,{m:function(){return useTokenApys}});var l=a(26361),s=a(88439),n=a(45438),i=a(76034),r=a(64103),o=a(75930),d=a(59175),u=a(19757),c=a(12396);function useTokenApys(){let e=(0,s.b)(()=>(0,l.Yb)({},0n)),t=(0,d.p)(),{prices:a,usbApr:m,stableVaultsState:x}=(0,r.useContext)(o.g),f=(0,i.a)(),h=(0,n.i)();return(0,r.useMemo)(()=>{let a=u.iK[t],s=(0,l.ok)(h[a[0].ptyPoolBelowAddress],"staking");e[u.O1[t]]=m.apr,e.USB_END=m.apr+s;let n=(0,c.v)("0.1",10);return a.forEach(t=>{if(t.assetTokenAddress!=u.K8){let a=f[t.vault]>1n?(0,c.v)("".concat((f[t.vault]-1).toFixed(2)),10):0n,l=(0,c.v)("1",10);e[t.xTokenAddress]=(a*(n-x[t.vault].Y*x[t.vault].aar/l)+n*l)/l}}),null},[t,a,f,m,h,x]),e}},76034:function(e,t,a){"use strict";a.d(t,{a:function(){return useValutsLeverageRatio},z:function(){return useVaultLeverageRatio}});var l=a(19757),s=a(26361),n=a(75930),i=a(64103),r=a(59175),o=a(88439);function useVaultLeverageRatio(e){let{vaultsState:t,stableVaultsState:a}=(0,i.useContext)(n.g),l=t[(null==e?void 0:e.vault)||"null"],r=a[(null==e?void 0:e.vault)||"null"],o=(null==e?void 0:e.isStable)?(0,s.pF)(r.aar,r.AARDecimals):(0,s.pF)(l.aar,l.AARDecimals);return Math.max(0,1+1/(o-1))}function useValutsLeverageRatio(){let{vaultsState:e,stableVaultsState:t}=(0,i.useContext)(n.g),a=(0,r.p)(),d=l.iK[a],u=(0,o.b)(()=>new Proxy({},{get:function(e,t){return t in e&&null!==e[t]&&void 0!==e[t]?e[t]:0}}));return d.forEach(a=>{let l=e[(null==a?void 0:a.vault)||"null"],n=t[(null==a?void 0:a.vault)||"null"],i=(null==a?void 0:a.isStable)?(0,s.pF)(n.aar,n.AARDecimals):(0,s.pF)(l.aar,l.AARDecimals);u[a.vault]=Math.max(0,1+1/(i-1))}),u}},84944:function(e,t,a){"use strict";a.d(t,{Rp:function(){return displayBalanceWithUnit},ZM:function(){return displayBalanceWithoutFormat},dq:function(){return displayBalance}});var l=a(7530),s=a(53060);let displayBalanceWithUnit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=arguments.length>2?arguments[2]:void 0;if(!e)return"0";let s=10**t,n=Math.floor(Number((0,l.b)(e,a))*s)/s,i=Number((.1**t).toFixed(t));return n>0&&n<i?"<"+i:n<0&&n>-i?"≈0":n.toLocaleString("en-US",{maximumFractionDigits:t})},displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return"0";let l=Number((0,s.d)(e)),n=Number((.1**t).toFixed(t));return l>0&&l<n?"<"+n:l<0&&l>-n?"≈0":l.toLocaleString("en-US",{...a||{},maximumFractionDigits:t})},displayBalanceWithoutFormat=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0";let a=10**t,l=Math.floor(Number((0,s.d)(e))*a)/a,n=Number((.1**t).toFixed(t));return l>0&&l<n?"<"+n:l<0&&l>-n?"≈0":String(l)}}},function(e){e.O(0,[7495,9633,4659,1996,1690,7122,1578,7638,7093,604,1744],function(){return e(e.s=30786)}),_N_E=e.O()}]);